# init_dir = "inits/v2/10m_hard_target"
init_dir = "inits/v2/10m_ablations/narrow_n3_5"
checkpoint_dir = "checkpoints"
seed = 42

[wandb]
enabled = true
project = "train-2048-hard-move"
entity = ""
run_name = ""
tags = []
mode = "online"                  # online | offline | disabled
report_every = 50                # log to W&B every N steps (>=1)

[target]
mode = "hard_move" # single 4-way policy head

[hyperparameters]
# learning_rate = 5e-4
learning_rate = 6e-4
grad_clip_norm = 1.0

[hyperparameters.lr_schedule]
name = "warmup-stable-decay" # constant | warmup-stable-decay
warmup_steps = 1500
cooldown_pct = 0.1
min_lr_ratio = 0.1

[hyperparameters.optimizer]
name = "adamw"      # adamw | muon
weight_decay = 0.01
beta1 = 0.9
beta2 = 0.98
eps = 1e-8

[batch]
# batch_size = 768
batch_size = 1024

[dropout]
dropout_prob = 0.03
attention_dropout_prob = 0.0

[dataset]
dataset_dir = "datasets/macroxue/d6_1b_v2"
mmap_mode = true
# num_steps = 34_000
num_steps = 50_000
# Limit step range to reduce endgame oversampling
# step_index_min = 0
# step_index_max = 5000

# Keep validation small and frequent for sanity
val_run_pct = 0.005
val_split_seed = 42
val_num_steps = 200
val_every = 5_000

[checkpoint]
every_epochs = 1
save_best_every_steps = 10000
best_min_delta = 0.002
